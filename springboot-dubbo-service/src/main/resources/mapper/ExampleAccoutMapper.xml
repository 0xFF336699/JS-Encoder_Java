<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lzq.dubboservice.mapper.ExampleAccountMapper">
    <sql id="Thebasic">
        a.example_id, example_name, ispublic, label, img, file_name, favorites, a.username
    </sql>

    <select id="queryByExampleName" resultType="com.lzq.api.dto.ExampleAccount">
        select
        a.username,
        name,
        user_picture,
        description,
        example_id,
        example_name,
        label,
        img,
        b.favorites,
        b.create_time,
        b.update_time
        from account a left join example b
        on
        a.username=b.username
        where
              b.example_name like concat('%',#{exampleName},'%')
        or    b.label like concat('%',#{exampleName},'%')
        <if test="orderCondition == 0">
            order by b.create_time desc
        </if>
        <if test="orderCondition == 1">
            order by b.update_time desc
        </if>
        <if test="orderCondition == 2">
            order by b.favorites desc
        </if>
    </select>

    <select id="queryPersonFavorites" resultType="com.lzq.api.dto.ExampleAccount">
        select a.username,
               name,
               user_picture,
               description,
               a.example_id,
               example_name,
               label,
               img,
               a.favorites
        from example a
                 left join favorites b
                           on
                               a.example_id = b.example_id
                 left join account c
                           on
                               a.username = c.username
        where b.username = #{username}
        <if test="orderCondition == 0">
            order by b.create_time desc
        </if>
        <if test="orderCondition == 1">
            order by b.update_time desc
        </if>
        <if test="orderCondition == 2">
            order by b.favorites desc
        </if>
    </select>
</mapper>